!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Intermediary=e():r.Intermediary=e()}(self,(()=>{return r={362:r=>{function e(r){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},e(r)}function t(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=o(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(r){throw r},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,f=!1;return{s:function(){t=t.call(r)},n:function(){var r=t.next();return u=r.done,r},e:function(r){f=!0,a=r},f:function(){try{u||null==t.return||t.return()}finally{if(f)throw a}}}}function n(r){return function(r){if(Array.isArray(r))return i(r)}(r)||function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||o(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(r,e){if(r){if("string"==typeof r)return i(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(r,e):void 0}}function i(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function a(r,e,t,n,o,i,a){try{var u=r[i](a),f=u.value}catch(r){return void t(r)}u.done?e(f):Promise.resolve(f).then(n,o)}function u(r){return function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function u(r){a(i,n,o,u,f,"next",r)}function f(r){a(i,n,o,u,f,"throw",r)}u(void 0)}))}}function f(r,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,(void 0,i=function(r,t){if("object"!==e(r)||null===r)return r;var n=r[Symbol.toPrimitive];if(void 0!==n){var o=n.call(r,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}(o.key),"symbol"===e(i)?i:String(i)),o)}var i}var l=function(){function r(e,t){!function(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this.middleware=e,this.afterware=t}var e,o,i;return e=r,o=[{key:"involve",value:function(r){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u((function*(){var i=[],a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=t,r.apply(void 0,t)};if(e.middleware){var u,f=n(e.middleware).reverse(),l=t(f);try{for(l.s();!(u=l.n()).done;){var c=u.value;a=yield c(o)(a)}}catch(r){l.e(r)}finally{l.f()}}var y=yield a.apply(void 0,arguments);if(e.afterware){var v=n(e.afterware).reverse();a=function(r){return r};var d,p=t(v);try{for(p.s();!(d=p.n()).done;){var s=d.value;a=yield s(o)(a)}}catch(r){p.e(r)}finally{p.f()}return a.apply(void 0,[y].concat(n(i)))}return y}))}}],i=[{key:"series",value:function(e,o,i){return u((function*(){var a=e.every((function(e){return e instanceof r}));if(!a)throw new Error("intermediaries should be instances of Intermediary");var u=n(e),f=u.pop(),l=f.involve(o,i).bind(f);u.reverse();var c,y=t(u);try{for(y.s();!(c=y.n()).done;){var v=c.value;l=v.involve(l,i).bind(v)}}catch(r){y.e(r)}finally{y.f()}return l.apply(void 0,arguments)}))}},{key:"createMiddleware",value:function(r){return function(e){return function(t){return function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return r.apply(void 0,[e,t].concat(o))}}}}},{key:"createAfterware",value:function(r){return function(e){return function(t){return function(n){for(var o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return r.apply(void 0,[e,t,n].concat(i))}}}}}],o&&f(e.prototype,o),i&&f(e,i),Object.defineProperty(e,"prototype",{writable:!1}),r}();r.exports=l,l.default=l}},e={},function t(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return r[n](i,i.exports,t),i.exports}(362);var r,e}));