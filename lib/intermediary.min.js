!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Intermediary=e():r.Intermediary=e()}(window,function(){return function(r){var e={};function n(t){if(e[t])return e[t].exports;var o=e[t]={i:t,l:!1,exports:{}};return r[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=r,n.c=e,n.d=function(r,e,t){n.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:t})},n.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},n.t=function(r,e){if(1&e&&(r=n(r)),8&e)return r;if(4&e&&"object"==typeof r&&r&&r.__esModule)return r;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:r}),2&e&&"string"!=typeof r)for(var o in r)n.d(t,o,function(e){return r[e]}.bind(null,o));return t},n.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return n.d(e,"a",e),e},n.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},n.p="",n(n.s=0)}([function(r,e,n){r.exports=n(1)},function(r,e){function n(r){return function(r){if(Array.isArray(r)){for(var e=0,n=new Array(r.length);e<r.length;e++)n[e]=r[e];return n}}(r)||function(r){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r))return Array.from(r)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function t(r,e,n,t,o,i,a){try{var u=r[i](a),f=u.value}catch(r){return void n(r)}u.done?e(f):Promise.resolve(f).then(t,o)}function o(r){return function(){var e=this,n=arguments;return new Promise(function(o,i){var a=r.apply(e,n);function u(r){t(a,o,i,u,f,"next",r)}function f(r){t(a,o,i,u,f,"throw",r)}u(void 0)})}}function i(r,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}var a=function(){function r(e,n){!function(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this.middleware=e,this.afterware=n}var e,t,a;return e=r,a=[{key:"series",value:function(e,n,t){return o(function*(){var o=e.pop(),i=o.involve(n,t).bind(o);e.reverse();var a=!0,u=!1,f=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var v=l.value;if(!(v instanceof r))throw new Error("intermediaries should be instances of Intermediary");i=v.involve(i,t).bind(v)}}catch(r){u=!0,f=r}finally{try{a||null==c.return||c.return()}finally{if(u)throw f}}return i.apply(void 0,arguments)})}},{key:"createMiddleware",value:function(r){return function(e){return function(n){return function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return r.apply(void 0,[e,n].concat(o))}}}}},{key:"createAfterware",value:function(r){return function(e){return function(n){return function(t){for(var o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return r.apply(void 0,[e,n,t].concat(i))}}}}}],(t=[{key:"involve",value:function(r){var e=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(function*(){var o=[],i=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return o=n,r.apply(void 0,n)};if(e.middleware){var a=e.middleware.reverse(),u=!0,f=!1,l=void 0;try{for(var c,v=a[Symbol.iterator]();!(u=(c=v.next()).done);u=!0){var y=c.value;i=yield y(t)(i)}}catch(r){f=!0,l=r}finally{try{u||null==v.return||v.return()}finally{if(f)throw l}}}var d=yield i.apply(void 0,arguments);if(e.afterware){var p=e.afterware.reverse();i=function(r){return r};var s=!0,b=!1,m=void 0;try{for(var w,h=p[Symbol.iterator]();!(s=(w=h.next()).done);s=!0){var g=w.value;i=yield g(t)(i)}}catch(r){b=!0,m=r}finally{try{s||null==h.return||h.return()}finally{if(b)throw m}}return i.apply(void 0,[d].concat(n(o)))}return d})}}])&&i(e.prototype,t),a&&i(e,a),r}();r.exports=a,a.default=a}])});